---
title: "Bio4158 - Devoir 3"
author: "Groupe XX - Nom1, Nom2, Nom3"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    number_sections: no
  html_document:
    df_print: paged
---

Here are the needed packages

```{r}
library(readr)
library(tidyverse)
library(ggplot2)
library(car)
library(performance)
library(see)
library(patchwork)
library(lmtest)
```

Loading data into R 

```{r}
setwd("/Users/apple/Desktop/BIO_4158 /BIO 4158 lab/Data sets BIO 4158")
getwd()

climate <- read_csv("climate.csv")

head(climate)
```




Answer the following questions. Total marks = 30.

1. What is the ‘biological’ (scientific) hypothesis? (1 point)

** Climate change is observed to be warming.
There is a variation in changes in temperature across different geographic location, and this pheonomena is causes by the variation in human activities across region **


2. What does this hypothesis predict in the context of her study? (2 points)

** This hypothesis predicts that warming is more prevalent in the Northern area compared to the Southern Area **


3. What is the associated null hypothesis? (2 points)

** H_o: North Area and South Are have the same increase in temparature **


4. To test this hypothesis, the student will need to quantify the extent of any climate change separately for each location. She’s interested not only in the point estimate of the rate of climate change for each location (which she needs for testing her biological hypothesis above), but also in its significance in each location (i.e. she wants to separately test whether there is evidence that climate has changed in any way at each site). Let’s start by conducting a regression analysis to test whether there is evidence of climate change in **Yarmouth**  
    a. What is the statistical null hypothesis relevant to the analysis ofthe Yarmouth data? (2 points)
    
    
   **There is no linear relationship between year and average tempterature in Yarmouth**
   
   b) What is the statistical model in the verbal form ? 
  
  Annual_Average_temperature = Year+ Error
    
    
  c) Provide a relevant plot of the Yarthmouth data
  
  **In this case, we would use the scatter plot**
  
```{r}
    Yarmouth <- climate %>% filter(loc=="Y") %>% arrange(year)

head(Yarmouth)

mygraph <- ggplot(
  data = Yarmouth[!is.na(Yarmouth$ave), ], # source of data
  aes(x = year, y = ave)
)
# plot data points, regression, loess trace
mygraph <- mygraph +
  stat_smooth(method = lm, se = FALSE, color = "green") + # add linear regression, but no SE shading
  stat_smooth(color = "red", se = FALSE) + # add loess
  geom_point() # add data points

mygraph
```
    
    
  d) Fit the model with and shows the R output 
    
```{r}
 RegModel.1 <- lm(ave ~ year, data = Yarmouth)
summary(RegModel.1)
```
  e) State the statistical assumptions for the analysis of Yarmouth data and provide some evidence that you examined them
  
  There are several assumptions that we have to make sure:


- No errors in X measurements
- Relationship between X and Y is linear
- Independence of residuals (no serial aurocorrelation)
- Residuals are normally distributed
- Homoscedasticity of residuals (even spread of residuals on X-axis) 


We will provide the graphs for visualization purpose only. We would not use them to intepret the valdity of our assumption




  **residuals plot**
  
```{r}
par(mfrow = c(2, 2), las = 1)
plot(RegModel.1)
```
  **Linearity plots**
```{r}
check_model(RegModel.1)

```

From here, we will start checking the validity of the assumptions using different types of test 

We use the Breusch-Pagan test examines whether the variability of the residuals is constant with respect to increasing fitted values

```{r}
bptest(RegModel.1)

```
From the output, we can see that the **p-value is 0.625 >0.05**, thus we fail to reject the null hypothesis. **Meaning, the variance is constant**


Next, we will use the the Durbin-Watson test to detect serial autocorrelation in the residuals. Under the assumption of no autocorrelation, the D statistic is 2.

```{r}
dwtest(RegModel.1)
```
From the output, we the **p-value is 0.01735 <0.05**, so we reject the null hypothesis. This means that **there is a autocorrelation** in the residuals 


Thirdly, we will use the the RESET test is a test of the assumption of linearity. If the linearity assumption is met, the RESET statistic will be close to 1.

```{r}
resettest(RegModel.1)

```
From the output, we can see that the RESET point = 7.689, which is way bigger than 1 ,and the p-value is 0.001153 <0.05. Thus, we can reject the Null Hypothesis and conclude that there is no linear relationship. 


Finally, we will use the Shapiro-Wilk normality test on the residual to confirm that the deviation from normality of the residuals is not large


```{r}
shapiro.test(residuals(RegModel.1))

```
  From the output, we can see that the p-value is 0.1807 > 0.05. Thus, the values do not deviate too much from Normal Distribution 
  
  


  
  
5. Yarmouth is only one of the six locations for which she needs to quantify the extent of any climate change. Plot the temporal trend for temperature separately for each station (2 points), and estimate the rate of change for each station (2 points).
6. Compute the mean warming rate in the North and in the South by averaging the rates calculated separately for each station (1 point). Calculate a 95% CI for each of these means based on the 3 replicates stations. (2 points). 


-----------------------

Do not forget if you want to use Rmarkdown, first add multiple empty lines between each questions then add code chunks to type your R code in them. and write your interpretation below.
    
    
    
    
    

# X. example question

```{r}
#write your code here

```

Write your interpretation